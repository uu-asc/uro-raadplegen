<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Collegegeld slider</title>
    <style>
        table {
            border-collapse: collapse;
        }
        td {
            text-align: right;
            padding: .25em;
        }
        th {
            text-align: left;
            padding: .25em;
        }
    </style>
</head>
<body>
    <main>
        <section class="settings">
            <fieldset class="periode">
                <legend>Periode</legend>
                <div>
                    <select name="startmaand" id="startmaand">
                        <option value="01" selected>september</option>
                        <option value="02">oktober</option>
                        <option value="03">november</option>
                        <option value="04">december</option>
                        <option value="05">januari</option>
                        <option value="06">februari</option>
                        <option value="07">maart</option>
                        <option value="08">april</option>
                        <option value="09">mei</option>
                        <option value="10">juni</option>
                        <option value="11">juli</option>
                        <option value="12">augustus</option>
                    </select>
                    <label for="startmaand">maand vanaf</label>
                </div>
                <div>
                    <select name="stopmaand" id="stopmaand">
                        <option value="01">september</option>
                        <option value="02">oktober</option>
                        <option value="03">november</option>
                        <option value="04">december</option>
                        <option value="05">januari</option>
                        <option value="06">februari</option>
                        <option value="07">maart</option>
                        <option value="08">april</option>
                        <option value="09">mei</option>
                        <option value="10">juni</option>
                        <option value="11">juli</option>
                        <option value="12" selected>augustus</option>
                    </select>
                    <label for="stopmaand">maand t/m</label>
                </div>
                <div>
                    <input type="text" id="nmaanden" name="nmaanden" value="12" size="3">
                    <label for="nmaanden">aantal maanden</label>
                </div>
            </fieldset>
            <fieldset class="getalsnotatie">
                <legend>Getalsnotatie</legend>
                <div>Settings</div>
                <div>
                    <input type="checkbox" name="ascurrency">
                    <label for="ascurrency">formatteer als bedrag</label>
                </div>
                <div>
                    <input type="checkbox" name="septhousands">
                    <label for="septhousands">scheidingsteken</label>
                </div>
                <div>Formaat</div>
                <div>
                    <input type="radio" id="locale-nl" name="locale" value="nl-NL" checked>
                    <label for="nl-NL">Nederlands</label>
                </div>
                <div>
                    <input type="radio" id="locale-en" name="locale" value="en-US">
                    <label for="nl-NL">Engels</label>
                </div>
            </fieldset>
        </section>
        <section class="data">
            <table border="1">
                <thead>
                    <tr style="text-align: right;">
                        <th></th>
                        <th>examentype</th>
                        <th>BA</th>
                        <th>MA</th>
                    </tr>
                    <tr>
                        <th>categorie</th>
                        <th>collegegeldtype</th>
                        <th></th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <th rowspan="2" valign="top" class="copyable">wettelijk</th>
                        <th class="copyable">Deeltijd</th>
                        <td class="copyable">1963</td>
                        <td class="copyable">1963</td>
                    </tr>
                    <tr>
                        <th class="copyable">Voltijd</th>
                        <td class="copyable">2209</td>
                        <td class="copyable">2209</td>
                    </tr>
                    <tr>
                        <th rowspan="3" valign="top" class="copyable">kleinschalig</th>
                        <th class="copyable">UCR</th>
                        <td class="copyable">3750</td>
                        <td class="copyable"></td>
                    </tr>
                    <tr>
                        <th class="copyable">PPE</th>
                        <td class="copyable">4418</td>
                        <td class="copyable"></td>
                    </tr>
                    <tr>
                        <th class="copyable">UCU</th>
                        <td class="copyable">4584</td>
                        <td class="copyable"></td>
                    </tr>
                    <tr>
                        <th rowspan="6" valign="top" class="copyable">niet-EER</th>
                        <th class="copyable">UCR</th>
                        <td class="copyable">9450</td>
                        <td class="copyable"></td>
                    </tr>
                    <tr>
                        <th class="copyable">LAAG</th>
                        <td class="copyable">11000</td>
                        <td class="copyable">17500</td>
                    </tr>
                    <tr>
                        <th class="copyable">PPE</th>
                        <td class="copyable">13100</td>
                        <td class="copyable"></td>
                    </tr>
                    <tr>
                        <th class="copyable">HOOG</th>
                        <td class="copyable">14000</td>
                        <td class="copyable">20750</td>
                    </tr>
                    <tr>
                        <th class="copyable">UCU</th>
                        <td class="copyable">14000</td>
                        <td class="copyable"></td>
                    </tr>
                    <tr>
                        <th class="copyable">TOP</th>
                        <td class="copyable">23300</td>
                        <td class="copyable">26700</td>
                    </tr>
                    <tr>
                        <th rowspan="5" valign="top" class="copyable">graad</th>
                        <th class="copyable">LAAG</th>
                        <td class="copyable">9895</td>
                        <td class="copyable">12295</td>
                    </tr>
                    <tr>
                        <th class="copyable">PPE</th>
                        <td class="copyable">12063</td>
                        <td class="copyable"></td>
                    </tr>
                    <tr>
                        <th class="copyable">HOOG</th>
                        <td class="copyable">12336</td>
                        <td class="copyable">14363</td>
                    </tr>
                    <tr>
                        <th class="copyable">UCU</th>
                        <td class="copyable">12336</td>
                        <td class="copyable"></td>
                    </tr>
                    <tr>
                        <th class="copyable">TOP</th>
                        <td class="copyable">20200</td>
                        <td class="copyable">23200</td>
                    </tr>
                </tbody>
            </table>
        </section>
    </main>
</body>
<script>
    let data = {"columns":["BA","MA"],"index":[["wettelijk","Deeltijd"],["wettelijk","Voltijd"],["kleinschalig","UCR"],["kleinschalig","PPE"],["kleinschalig","UCU"],["niet-EER","UCR"],["niet-EER","LAAG"],["niet-EER","PPE"],["niet-EER","HOOG"],["niet-EER","UCU"],["niet-EER","TOP"],["graad","LAAG"],["graad","PPE"],["graad","HOOG"],["graad","UCU"],["graad","TOP"]],"data":[[1963,1963],[2209,2209],[3750,null],[4418,null],[4584,null],[9450,null],[11000,17500],[13100,null],[14000,20750],[14000,null],[23300,26700],[9895,12295],[12063,null],[12336,14363],[12336,null],[20200,23200]]}

    let selectStartmaand = document.querySelector(`[name="startmaand"]`)
    let selectStopmaand = document.querySelector(`[name="stopmaand"]`)
    let inputNMaanden = document.querySelector(`[name="nmaanden"]`)
    let checkboxAsCurrency = document.querySelector(`[name="ascurrency"]`)
    let radioLocaleNL = document.querySelector(`#locale-nl`)
    let tabel = document.querySelector("table")

    function formatNumber(i) {
        let locale = document.querySelector('input[name="locale"]:checked').value
        if ( i === 0 ) { return "" }
        if ( !checkboxAsCurrency.checked ) {
            let options = {
                "trailingZeroDisplay": "stripIfInteger",
                "useGrouping": document.querySelector('input[name="septhousands"]').checked,
                "minimumFractionDigits": 2,
                "maximumFractionDigits": 2,
            }
            return i.toLocaleString(locale, options)
        }
        let options = {
            "currency": "EUR",
            "style": "currency",
            "useGrouping": document.querySelector('input[name="septhousands"]').checked,
        }
        return i.toLocaleString(locale, options)
    }

    function updateTable(data) {
        let nmaanden = parseInt(inputNMaanden.value)
        Array.from(tabel.tBodies[0].rows).forEach((row, rowidx) => {
            let cells = row.querySelectorAll("td")
            cells.forEach((cell, colidx) => {
                let bedrag = ( data[rowidx][colidx] / 12 ) * nmaanden
                cell.innerText = formatNumber(bedrag)
            })
        })
    }

    function updateInputsMaanden() {
        Array.from(selectStopmaand.options).forEach(option => {
            if ( option.value < selectStartmaand.value ) {
                option.setAttribute("hidden", "")
            } else {
                option.removeAttribute("hidden", "")
            }
        })

        Array.from(selectStartmaand.options).forEach(option => {
            if ( option.value > selectStopmaand.value ) {
                option.setAttribute("hidden", "")
            } else {
                option.removeAttribute("hidden", "")
            }
        })

        let diff = parseInt(selectStopmaand.value) - parseInt(selectStartmaand.value) + 1
        inputNMaanden.value = diff
        updateTable(data.data)
    }

    document.addEventListener("change", event => {
        if ( event.target.matches(`[name$=maand]`) ) { updateInputsMaanden() }
        if ( event.target.matches(`[name="nmaanden"]`) ) { updateTable(data.data) }
        if ( event.target.closest("fieldset")?.classList.contains("getalsnotatie") ) { updateTable(data.data) }
    })
</script>
</html>
